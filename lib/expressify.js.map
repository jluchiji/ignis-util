{"version":3,"sources":["expressify.js"],"names":[],"mappings":";;;;;;;;;;;;qBAmBwB,UAAU;;;;;wBAZV,UAAU;;;;;;;;;;;;;;;AAYnB,SAAS,UAAU,CAAC,EAAE,EAAgB;MAAd,MAAM,yDAAG,GAAG;;;AAGjD,MAAI,EAAE,CAAC,WAAW,EAAE,EAAE;;AACpB,UAAM,SAAS,GAAG,sBAAS,SAAS,CAAC,EAAE,CAAC,CAAC;AACzC;WAAO,UAAS,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE;AAC9B,iBAAO,SAAS,CAAC,GAAG,CAAC,CAClB,IAAI,CAAC,UAAA,IAAI;mBAAI,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;WAAA,CAAC,SACtC,CAAC,IAAI,CAAC,CAAC;SAChB;QAAC;;;;;GACH;;;AAGD,SAAO,UAAS,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE;AAC9B,WAAO,4BACD,CAAC,YAAS;AAAE,aAAO,EAAE,CAAC,GAAG,CAAC,CAAC;KAAE,CAAC,CACjC,IAAI,CAAC,UAAA,IAAI,EAAI;AAAE,SAAG,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAAE,CAAC,SAC3C,CAAC,IAAI,CAAC,CAAC;GAChB,CAAC;CAEH","file":"expressify.js","sourcesContent":["/**\n * util/expressify.js\n *\n * @author  Denis Luchkin-Zhou <denis@ricepo.com>\n * @license MIT\n */\n\nimport Bluebird    from 'bluebird';\n\n/**\n * expressify(2)\n *\n * @description                Wraps a promise-producing function into an\n *                             express middleware that responds with the promise\n *                             results if resolved; invokes error handler stack\n *                             if rejected.\n * @param          {fn}        Promise-producing handler function.\n * @param          {status}    Status code to return on success (default: 200).\n */\nexport default function expressify(fn, status = 200) {\n\n  /* If fn is a generator, use coroutines */\n  if (fn.isGenerator()) {\n    const coroutine = Bluebird.coroutine(fn);\n    return function(req, res, next) {\n      return coroutine(req)\n        .then(data => res.status(status).send(data))\n        .catch(next);\n    };\n  }\n\n  /* Otherwise, unpromisify */\n  return function(req, res, next) {\n    return Bluebird\n      .try(()    => { return fn(req); })\n      .then(data => { res.status(status).send(data); })\n      .catch(next);\n  };\n\n}\n"],"sourceRoot":"/source/"}